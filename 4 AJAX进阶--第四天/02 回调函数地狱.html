<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>回调地狱</title>
</head>

<body>
    <form>
        <span>省份：</span>
        <select>
            <option class="province"></option>
        </select>
        <span>城市：</span>
        <select>
            <option class="city"></option>
        </select>
        <span>地区：</span>
        <select>
            <option class="area"></option>
        </select>
    </form>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        /**
         * 目标：演示回调函数地狱
         * 需求：获取默认第一个省，第一个市，第一个地区并展示在下拉菜单中
         * 概念：在回调函数中嵌套回调函数，一直嵌套下去就形成了回调函数地狱
         * 缺点：可读性差，异常无法获取，耦合性严重，牵一发动全身
        */

        // 1.获取默认第一个省份的名字
        axios({ url: 'http://hmajax.itheima.net/api/province' }).then(res => {
            const pname = res.data.list[0]
            document.querySelector('.province').innerHTML = pname
            // 2.获取默认第一个城市的名字
            axios({ url: 'http://hmajax.itheima.net/api/city', params: { pname } }).then(res => {
                const cname = res.data.list[0]
                document.querySelector('.city').innerHTML = cname
                // 3.获取默认第一个地区的名字
                axios({ url: 'http://hmajax.itheima.net/api/area', params: { pname, cname } }).then(res => {
                    const areaName = res.data.list[0]
                    document.querySelector('.area').innerHTML = areaName
                })
            })
        }).catch(error => {
            // 外层的异常捕获无法获取内层的异常，只能获取当前层的异常
            console.log(error);
        })
    </script>
</body>

</html>

<!--  
1. 什么是回调函数地狱？
➢ 在回调函数一直向下嵌套回调函数，形成回调函数地狱
2. 回调函数地狱问题？
➢ 可读性差
➢ 异常捕获困难
➢ 耦合性严重，牵一发动全身


 -->